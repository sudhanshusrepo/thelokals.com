(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[620],{1104:(e,s,t)=>{"use strict";t.d(s,{N:()=>c});var l=t(9199),a=t(3680);let i=e=>{try{if(void 0!==a&&a.env)return a.env[e]}catch{}},r={SUPABASE_URL:void 0!==a&&"https://gdnltvvxiychrsdzenia.supabase.co"||void 0!==a&&a.env?.VITE_SUPABASE_URL||i("EXPO_PUBLIC_SUPABASE_URL")||"https://placeholder.supabase.co",SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0",GOOGLE_MAPS_KEY:void 0!==a&&a.env?.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY||void 0!==a&&a.env?.VITE_GOOGLE_MAPS_API_KEY||i("EXPO_PUBLIC_GOOGLE_MAPS_API_KEY")||"",IS_DEV:"true"===i("DEV"),IS_TEST_MODE:void 0!==a||void 0!==a&&a.env?.VITE_TEST_MODE==="true"||"true"===i("EXPO_PUBLIC_TEST_MODE"),ENABLE_OTP_BYPASS:void 0!==a||void 0!==a&&a.env?.VITE_ENABLE_OTP_BYPASS==="true"||"true"===i("EXPO_PUBLIC_ENABLE_OTP_BYPASS")},n=r.SUPABASE_URL||"https://placeholder.supabase.co",o=r.SUPABASE_ANON_KEY||"placeholder";"https://placeholder.supabase.co"===n&&console.warn("⚠️ Supabase environment variables are missing! Using placeholder values. Auth will not work.");let c=(0,l.UU)(n,o,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{Accept:"application/json"}}})},3551:(e,s,t)=>{Promise.resolve().then(t.bind(t,5837))},5837:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var l=t(4568),a=t(7620),i=t(1104),r=t(9748);function n(){let e=(0,r.useParams)().id;(0,r.useRouter)();let[s,t]=(0,a.useState)(null),[n,o]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let s=async()=>{let{data:s,error:l}=await i.N.from("bookings").select("*").eq("id",e).single();if(s&&(t(s),"ACCEPTED"===s.status||"IN_PROGRESS"===s.status)){let{data:t}=await i.N.from("booking_otp").select("otp_code").eq("booking_id",e).single();if(t)o(t.otp_code);else if("ACCEPTED"===s.status){let{data:s,error:t}=await i.N.rpc("generate_booking_otp",{p_booking_id:e});s&&o(s)}}};s();let l=setInterval(s,3e3);return()=>clearInterval(l)},[e]),s)?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,l.jsxs)("div",{className:"bg-white p-4 shadow-sm text-center",children:[(0,l.jsxs)("h1",{className:"font-bold",children:["Booking #",e.slice(0,8)]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:s.status.replace("_"," ")})]}),(0,l.jsxs)("div",{className:"flex-1 p-6 flex flex-col items-center justify-center",children:["PENDING"===s.status&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin text-4xl mb-4",children:"⏳"}),(0,l.jsx)("h2",{className:"text-xl font-bold",children:"Looking for Provider..."}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Please wait, this usually takes 2-5 minutes."})]}),"ACCEPTED"===s.status&&(0,l.jsxs)("div",{className:"text-center w-full max-w-sm bg-white p-6 rounded-xl shadow-lg",children:[(0,l.jsx)("div",{className:"text-green-500 text-5xl mb-4",children:"✓"}),(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Provider Found!"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Share this PIN with provider to start job."}),(0,l.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg border-2 border-dashed border-gray-300",children:(0,l.jsx)("span",{className:"text-4xl font-mono font-bold tracking-widest text-indigo-600",children:n||"...."})})]}),"IN_PROGRESS"===s.status&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-blue-500 text-5xl mb-4",children:"⚙️"}),(0,l.jsx)("h2",{className:"text-xl font-bold",children:"Work In Progress"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Your service is being fulfilled."})]}),"COMPLETED"===s.status&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-yellow-500 text-5xl mb-4",children:"⭐"}),(0,l.jsx)("h2",{className:"text-xl font-bold",children:"Job Completed!"}),(0,l.jsxs)("p",{className:"text-gray-500 mt-2 mb-4",children:["Total Amount: ₹",s.final_cost/100]}),(0,l.jsx)("button",{className:"bg-black text-white px-6 py-2 rounded-lg",children:"Pay Now"})]})]})]}):(0,l.jsx)("div",{className:"p-10 text-center",children:"Loading booking..."})}}},e=>{e.O(0,[740,587,968,358],()=>e(e.s=3551)),_N_E=e.O()}]);